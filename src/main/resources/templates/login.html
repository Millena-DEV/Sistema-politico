<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link rel="icon" th:href="@{/img/ub.jfif}" />
  <title th:href="@{/img/ub.jfif}">UNIÃO BRASIL</title>
  <link rel="icon" th:href="@{/img/ub.jfif}" />
  <link rel="stylesheet" th:href="@{https://use.fontawesome.com/releases/v5.15.2/css/all.css}" />
  <link rel="stylesheet" th:href="@{https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap}" />
  <link rel="stylesheet" th:href="@{/css/bootstrap-login-form.min.css}" />
</head>
<style>
  body, html {
    height: 100%;
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    background: linear-gradient(to bottom, #00A4E8, #053383); /* Céu com gradiente */
    overflow: hidden;
  }


  .geometric-shape {
    transition: transform 0.5s ease;
  }

  /* Estilo do SVG */
  .background_svg {
    width: 100%;
    height: 100%;
  }



  
  /* Estilos básicos para o formulário */
  #formulario-recuperacao {
      display: none;
      margin-top: 20px;
      padding: 10px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  }

  /* Estilo adicional para o resultado da recuperação */
  #resultado {
      margin-top: 20px;
  }

  .rodape {
      margin-top: 10px;
      text-align: center;
      color: #393f81;
  }
</style>
<body>
  
    <div class="container py-5 h-100">
      <div class="row d-flex justify-content-center align-items-center h-100">
        <div class="col col-xl-10">
          <div class="card" style="border-radius: 1rem;">
            <div class="row g-0">
              <div class="col-md-6 col-lg-5 d-none d-md-block">
                <img
                  th:src="@{https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-login-form/img1.webp}"
                  alt="login form"
                  class="img-fluid" style="border-radius: 1rem 0 0 1rem;"
                />
              </div>
              <div class="col-md-6 col-lg-7 d-flex align-items-center">
                <div class="card-body p-4 p-lg-5 text-black">
                  <form th:action="@{/login}" method="post">
                    <div class="d-flex align-items-center mb-3 pb-1">
                      <i class="fas fa-cubes fa-2x me-3" style="color: #2819ff;"></i>
                      <img th:src="@{/img/Uniao_Brasil_Logo_LATERAL-2.png}" style="width: 50%;" />
                      <span class="h1 fw-bold mb-0"></span>
                    </div>

                    <h5 class="fw-normal mb-3 pb-3" style="letter-spacing: 1px;">Entrar em sua Conta</h5>

                    <div th:if="${error}" class="alert alert-danger" role="alert">
                      Credenciais inválidas, tente novamente.
                  </div>
                  

                    <div class="form-outline mb-4">
                      <input type="text" id="form2Example17" class="form-control form-control-lg" name="username" required aria-label="Email" />
                      <label class="form-label" for="form2Example17">Email</label>
                    </div>

                    <div class="form-outline mb-4">
                      <input type="password" id="form2Example27" class="form-control form-control-lg" name="password" required aria-label="Senha" />
                      <label class="form-label" for="form2Example27">Senha</label>
                    </div>

                    <div class="pt-1 mb-4">
                      <button class="btn btn-dark btn-lg btn-block" type="submit">Login</button>
                    </div>
                    <a href="javascript:void(0);" onclick="mostrarModal()" style="color: #393f81; font-size: 18px; text-align: center;">
                      <b>Esqueci a Senha</b>
                    </a>
                    
                    <br>
                  
                  </form>
                  <br> <br> <br> <br> <br> <br> <br> <br> 
                  <div class="rodape">
                   
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

       <!-- Modal de Recuperação de Senha -->
<div class="modal fade" id="modalRecuperacao" tabindex="-1" aria-labelledby="modalRecuperacaoLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <!-- Cabeçalho -->
      <div class="modal-header bg-warning text-white">
        <h5 class="modal-title" id="modalRecuperacaoLabel">Redefinir Senha</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <!-- Corpo -->
      <div class="modal-body">
        <p class="text-muted">Informe seu e-mail cadastrado abaixo. Enviaremos um link para recuperação da sua senha.</p>

        <!-- Formulário de Recuperação -->
        <form id="form-recuperacao">
          <div class="mb-3">
            <input type="email" id="email" name="email" class="form-control" placeholder="Digite seu e-mail" required>
          </div>

          <!-- Botão Enviar -->
          <div class="d-grid gap-2">
            <button type="submit" class="btn btn-info" onclick="resetSenha(event)">Enviar Link de Recuperação</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<style>
  /* Estilo para o cabeçalho da modal */
#modalRecuperacao .modal-header {
    background-color: #007bff;
    color: white;
    text-align: center;
}

/* Estilo para o texto do corpo da modal */
#modalRecuperacao .modal-body p {
    font-size: 1rem;
    font-weight: 400;
    text-align: center;
}

/* Estilo para o campo de input */
#modalRecuperacao .form-control {
    border-radius: 30px;  /* Bordas arredondadas */
    padding: 15px;  /* Aumenta o espaço interno do campo */
    font-size: 1.1rem;  /* Aumenta o tamanho da fonte */
}

/* Estilo para o botão */
#modalRecuperacao .btn-primary {
    background-color: #28a745;  /* Cor de fundo verde */
    border: none;
    border-radius: 25px;  /* Bordas arredondadas */
    padding: 12px;  /* Aumenta o tamanho do botão */
    font-size: 1.1rem;  /* Aumenta o tamanho da fonte */
    transition: background-color 0.3s ease-in-out;
}

/* Efeito hover no botão */
#modalRecuperacao .btn-primary:hover {
    background-color: #218838;  /* Cor mais escura ao passar o mouse */
}

</style>


  <!-- Área para exibir mensagens de sucesso ou erro -->
  <div id="resultado"></div>
 

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Função para exibir o modal de recuperação de senha
    function mostrarModal() {
      console.log('Exibindo o modal de recuperação...');
      var myModal = new bootstrap.Modal(document.getElementById('modalRecuperacao'));
      myModal.show();
    }
    
      function resetSenha() {
          var email = $("#email").val();  // Pega o e-mail do campo de input

          if (!email) {
            alert('Por favor, digite um e-mail válido.');
            return;
        }
          // Desabilita o botão para evitar múltiplos cliques
          var btnEnviar = $(".btn-primary");
        btnEnviar.prop("disabled", true).text("Enviando...");  

        var data = { email: email };  // O corpo da requisição com o e-mail
    
        $.ajax({
          url: "/api/envia-email",  // URL da API
          type: "POST",
          data: JSON.stringify(data),  // Converte o objeto para JSON
          contentType: "application/json",  // Especifica que o conteúdo é JSON
          dataType: "json",  // Espera resposta JSON
          success: function(response) {
              alert(response.message);  // Exibe a mensagem de sucesso
              // Redireciona para a página de login após o sucesso
              setTimeout(function() {
                  window.location.href = "/login";  // Redireciona para a página de login
              }, 2000); // Aguarda 2 segundos para mostrar a mensagem antes de redirecionar
          },
          complete: function() {
              // Sempre habilita o botão novamente após a requisição (sucesso ou erro)
              btnEnviar.prop("disabled", false).text("Enviar Código");
          }
      });
    }
    
    
  
  
  
  

  
  
  
    
  </script>

  <script type="text/javascript" th:src="@{/js/mdb.min.js}"></script>
  <script type="text/javascript" th:src="@{/js/mdb.min.js}"></script>
  <script type="text/javascript"></script>
</body>

</html>
